## Конструктор бизнес-процессов (web)

Веб‑приложение для быстрого описания бизнес‑процессов в текстовом виде и автоматической визуализации в формате графа с дорожками (swimlane) по отделам.

### Возможности

- Описание процесса в виде списка шагов с указанием:
  - названия шага;
  - типа шага (задача, логическое условие да/нет, И, ИЛИ);
  - отдела/исполнителя.
- Визуализация процесса в виде графа:
  - горизонтальные полосы‑swimlane по отделам;
  - узлы‑задачи в прямоугольниках;
  - узлы‑условия в ромбах.
- Редактирование процесса:
  - добавление/удаление отделов;
  - добавление/удаление шагов;
  - изменение порядка шагов перетаскиванием (drag & drop).
- Сохранение процесса в `process.json` и автоматическая загрузка последней сохранённой версии.

### Стек

- Python 3.9+
- Flask
- vis-network (через CDN)

### Установка и запуск

```bash
git clone https://github.com/wanga1712/graf_builder_bpmn.git
cd graf_builder_bpmn

python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

pip install flask

python web_app.py
```

После запуска приложение будет доступно по адресу `http://127.0.0.1:5000/`.

### Структура проекта

- `web_app.py` — Flask-приложение, API для работы с процессом.
- `web_index.html` — веб‑интерфейс конструктора и визуализации.
- `domain.py` — доменная модель процесса (узлы, связи, преобразование в/из структурированных данных).
- `process.json` — сохранённое состояние процесса (отделы и шаги).

1. Запуск программы
При запуске программы вызывается блок if __name__ == "__main__":, который создает экземпляр класса GraphInputApp и вызывает app.mainloop(), чтобы запустить главный цикл приложения Tkinter.
2. Инициализация GraphInputApp
В момент создания объекта класса GraphInputApp, срабатывает метод __init__, который:
Вызывает конструктор базового класса Tk.
Настраивает параметры окна.
Создает экземпляр класса Graph и сохраняет его в атрибуте self.graph.
Логирует процесс в файл debug.log.
Вызывает метод create_widgets.
3. Создание виджетов в GraphInputApp
Метод create_widgets создает и размещает графические элементы (метки, поля ввода, кнопки и комбобоксы) для взаимодействия с пользователем. Среди них:
Поля для добавления узлов и связей.
Кнопки для выполнения действий (например, добавление узла, отображение графа).
При возникновении ошибки, она будет логироваться и выводиться пользователю через self.graph.show_error.
После создания виджетов вызывается метод create_edge_widgets для создания дополнительных элементов управления связями.
4. Взаимодействие с пользователем
Пользователь вводит данные (например, названия узлов, типы узлов) и нажимает кнопки для выполнения операций (например, добавление узла или связи). В результате:
Если пользователь нажимает кнопку "Добавить узел", вызывается метод insert_node.
Если нажимается кнопка "Добавить связь", вызывается метод insert_edge.
5. Добавление узла в граф
Метод insert_node:
Получает данные из виджетов для узла (название узла и тип).
Передает эти данные в метод add_node объекта Graph для добавления нового узла в граф.
Обновляет выпадающие списки узлов, вызывая метод update_edge_menus.
6. Добавление связи между узлами
Метод insert_edge:
Получает данные для связи (исходный узел, целевой узел и метку).
Передает эти данные в метод add_edge объекта Graph для добавления связи между узлами в граф.
7. Взаимодействие с классом Graph
При добавлении узла или связи, методы add_node и add_edge класса Graph:
Проверяют корректность данных (например, существует ли узел или связь уже).
Обновляют структуру графа (списки узлов и связей).
Визуализируют граф, вызывая метод show_graph, который перерисовывает граф с учетом изменений.
Логируют успешные действия или ошибки.
8. Отображение графа
Метод show_graph класса Graph:
Рендерит граф с использованием библиотеки graphviz.
Сохраняет результат в формате SVG.
Открывает сгенерированное изображение графа в браузере.
9. Завершение программы
Программа работает в цикле событий (mainloop), и пользователь может продолжать взаимодействие с интерфейсом до закрытия окна приложения.
Резюме шагов:
Запуск программы и создание объекта GraphInputApp.
Инициализация интерфейса через методы __init__, create_widgets, create_edge_widgets.
Пользователь взаимодействует с элементами интерфейса.
Методы insert_node и insert_edge взаимодействуют с классом Graph для добавления узлов и связей.
Класс Graph обрабатывает данные и отображает граф через метод show_graph.
Программа продолжает работу в цикле событий, позволяя пользователю выполнять действия.



связи вроде верные, правда словарь вообще наверное теперь можно убрать смотри по логам, а вот проблема с выводом теперь образовалась, после того как ты изменил код не отображается визуально ничего. видимо логика должна быть такой, что нам нужно сделать следующее